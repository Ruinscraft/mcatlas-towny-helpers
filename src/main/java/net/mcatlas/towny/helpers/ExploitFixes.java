package net.mcatlas.towny.helpers;

import com.palmergames.bukkit.towny.TownyAPI;
import org.bukkit.ChatColor;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerTeleportEvent;

public class ExploitFixes implements Listener {

    @EventHandler
    public void doNotTeleportUsersIntoTownClaimsWithChorusFruit(PlayerTeleportEvent event) {
        if (event.getCause() != PlayerTeleportEvent.TeleportCause.CHORUS_FRUIT) {
            return;
        }

        String townName = TownyAPI.getInstance().getTownName(event.getTo());

        // there was a town claim at the randomly chosen location
        if (townName != null) {
            event.getPlayer().sendMessage(ChatColor.RED + "Your teleport was canceled because of a town claim.");
            event.setCancelled(true);
        }
    }

}
